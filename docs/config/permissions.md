# 权限系统

CzAreaProtection 拥有一个灵活的权限系统，允许区域所有者精细控制其他玩家在其区域内的行为。

## 核心概念

-   **权限 (Permission)**: 代表一个具体的操作或行为，例如 `break` (破坏方块)、`place` (放置方块)、`interactEntity` (实体交互) 等。每个权限都有一个唯一的 ID、名称、描述和类别。
-   **权限组 (Permission Group)**: 一个包含多个权限的集合。玩家可以创建自定义的权限组，并将这些组分配给其他玩家或设置为区域的默认权限组。
-   **区域所有者 (Owner)**: 创建区域的玩家。默认拥有其创建区域的所有权限。
-   **领地管理员 (Area Admin)**: 通过 `/areaadmin op <玩家名>` 命令设置的管理员。拥有服务器上所有区域的所有权限，优先级最高。
-   **默认权限**:
    -   **系统默认权限**: 在 `config.json` 的 `defaultGroupPermissions` 中定义。当一个区域没有设置默认权限组，且玩家在该区域没有特定权限组时，将使用这些权限。
    -   **区域默认权限组**: 区域所有者可以为自己的区域设置一个自定义的权限组作为默认组。当玩家进入该区域且没有特定权限组时，将使用此默认组的权限。优先级高于系统默认权限。
-   **玩家特定权限组**: 区域所有者可以为特定玩家在自己的区域内分配一个自定义权限组。这是最高优先级的权限设置（仅次于领地管理员和所有者）。
-   **子区域权限**: 子区域的权限检查优先于父区域。检查顺序：子区域特定玩家组 -> 子区域默认组 -> 父区域特定玩家组 -> 父区域默认组 -> 系统默认权限。

## 权限检查顺序

当玩家尝试在区域内执行某个操作时，插件会按以下顺序检查权限：

1.  **领地管理员?**: 如果玩家是领地管理员，允许操作。
2.  **区域所有者?**: 如果玩家是当前区域（或其父区域，如果是子区域）的所有者，允许操作。
3.  **子区域特定玩家组?**: (仅限子区域) 检查玩家是否在子区域被分配了特定权限组，并检查该组是否包含所需权限。
4.  **子区域默认组?**: (仅限子区域) 检查子区域是否设置了默认权限组，并检查该组是否包含所需权限。
5.  **父区域特定玩家组?**: (仅限子区域) 检查玩家是否在父区域被分配了特定权限组，并检查该组是否包含所需权限。
6.  **父区域默认组?**: (仅限子区域) 检查父区域是否设置了默认权限组，并检查该组是否包含所需权限。
7.  **(主/子)区域特定玩家组?**: 检查玩家是否在当前区域被分配了特定权限组，并检查该组是否包含所需权限。
8.  **(主/子)区域默认组?**: 检查当前区域是否设置了默认权限组，并检查该组是否包含所需权限。
9.  **系统默认权限?**: 检查 `config.json` 中定义的系统默认权限列表是否包含所需权限。
10. **拒绝**: 如果以上检查均未通过，则拒绝操作。

## 可用权限列表

以下是插件当前支持的所有权限，按类别分组：

### 建筑

| ID          | 名称       | 描述                     |
| :---------- | :--------- | :----------------------- |
| `break`     | 破坏方块   | 允许在区域内破坏方块     |
| `place`     | 放置方块   | 允许在区域内放置方块     |

### 物品

| ID                   | 名称           | 描述                         |
| :------------------- | :------------- | :--------------------------- |
| `pickupItems`        | 捡起物品       | 允许在区域内捡起物品         |
| `dropItems`          | 丢出物品       | 允许在区域内丢出物品         |
| `useItem`            | 使用物品       | 允许在区域内使用物品         |
| `useBow`             | 使用弓         | 允许在区域内使用弓           |
| `useBucket`          | 使用桶         | 允许在区域内使用桶           |
| `useCrossbow`        | 使用弩         | 允许在区域内使用弩           |
| `useTrident`         | 使用三叉戟     | 允许在区域内使用三叉戟       |
| `usePotion`          | 使用药水       | 允许在区域内使用普通药水     |
| `useSplashPotion`    | 使用喷溅药水   | 允许在区域内使用喷溅药水     |
| `useLingeringPotion` | 使用滞留药水   | 允许在区域内使用滞留药水     |
| `useExpBottle`       | 使用附魔之瓶   | 允许在区域内使用附魔之瓶     |

### 交互

| ID                      | 名称               | 描述                                                     |
| :---------------------- | :----------------- | :------------------------------------------------------- |
| `rideEntity`            | 乘骑实体           | 允许在区域内乘骑指定的实体 (如: 船, 矿车, 马等)         |
| `interactEntity`        | 实体交互           | 允许在区域内与指定的实体交互 (如: 村民, 带箱矿车等)     |
| `armorStand`            | 操作盔甲架         | 允许在区域内操作盔甲架                                   |
| `usePressurePlate`      | 踩压力板           | 允许在区域内踩压力板                                     |
| `useDaylightDetector`   | 使用阳光探测器     | 允许在区域内使用阳光探测器                               |
| `useCauldron`           | 使用炼药锅         | 允许在区域内使用炼药锅                                   |
| `useComparator`         | 使用红石比较器     | 允许在区域内使用红石比较器                               |
| `useRepeater`           | 使用红石中继器     | 允许在区域内使用红石中继器                               |
| `useNoteblock`          | 使用音符盒         | 允许在区域内使用音符盒                                   |
| `useJukebox`            | 使用唱片机         | 允许在区域内使用唱片机                                   |
| `useButton`             | 使用按钮           | 允许在区域内使用按钮                                     |
| `useLever`              | 使用拉杆           | 允许在区域内使用拉杆                                     |
| `useComposter`          | 使用堆肥桶         | 允许在区域内使用堆肥桶                                   |
| `useDoor`               | 使用门             | 允许在区域内使用门                                       |
| `useTrapdoor`           | 使用活板门         | 允许在区域内使用活板门                                   |
| `useFenceGate`          | 使用栅栏门         | 允许在区域内使用栅栏门                                   |
| `useCampfire`           | 使用营火           | 允许在区域内使用营火                                     |
| `useBeehive`            | 使用蜂巢/蜂箱      | 允许在区域内使用蜂巢或蜂箱                               |
| `useBookshelf`          | 使用书架           | 允许在区域内使用雕纹书架                                 |
| `useSuspiciousBlock`    | 使用可疑方块       | 允许在区域内使用可疑的沙子或沙砾                         |
| `useRespawnAnchor`      | 使用重生锚         | 允许在区域内使用重生锚                                   |
| `useCandle`             | 使用蜡烛           | 允许在区域内使用蜡烛                                     |
| `useSign`               | 使用告示牌         | 允许在区域内使用告示牌                                   |
| `interactDragonEgg`     | 交互龙蛋           | 允许在区域内交互龙蛋                                     |
| `itemFrame`             | 操作展示框         | 允许在区域内操作展示框                                   |
| `useBed`                | 使用床             | 允许在区域内使用床                                       |
| `useItemOnBlock`        | 对方块使用物品     | 允许在区域内对方块使用物品                               |
| `interactBlock`         | 方块互动           | 允许在区域内与方块互动                                   |
| `useShovel`             | 使用铲子           | 允许在区域内使用铲子转换草方块、泥土等                   |
| `useAxe`                | 使用斧头           | 允许在区域内使用斧头转换原木等方块                       |
| `useHoe`                | 使用锄头           | 允许在区域内使用锄头转换泥土、草方块等                   |
| `attackBlock`           | 攻击方块           | 允许在区域内攻击方块                                     |
| `attackEntity`          | 攻击实体           | 允许在区域内攻击实体                                     |
| `attackMinecart`        | 攻击矿车           | 允许在区域内攻击矿车                                     |
| `attackPlayer`          | 攻击玩家           | 允许在区域内攻击其他玩家                                 |
| `attackAnimal`          | 攻击动物           | 允许在区域内攻击动物                                     |
| `attackMonster`         | 攻击怪物           | 允许在区域内攻击怪物                                     |
| `useFishingRod`         | 使用钓鱼竿         | 允许在区域内使用钓鱼竿                                   |
| `placeMinecart`         | 放置矿车           | 允许在区域内的铁轨上放置矿车                             |
| `interactVillager`      | 与村民交互         | 允许在区域内与村民交易或互动                             |
| `interactChestBoat`     | 与船箱交互         | 允许在区域内与装有箱子的船交互                           |
| `interactChestMinecart` | 与矿车箱子交互     | 允许在区域内与装有箱子的矿车交互                         |
| `rideBoat`              | 乘坐船             | 允许在区域内乘坐船                                       |
| `rideMinecart`          | 乘坐矿车           | 允许在区域内乘坐矿车                                     |
| `rideHorse`             | 骑马               | 允许在区域内骑马和其他类似坐骑                           |

### 容器

| ID                   | 名称           | 描述                               |
| :------------------- | :------------- | :--------------------------------- |
| `openchest`          | 打开箱子       | 允许打开区域内的箱子               |
| `openEnderchest`     | 打开末影箱     | 允许打开末影箱                     |
| `opentRapped_chest`  | 打开陷阱箱     | 允许打开陷阱箱                     |
| `openCrafting`       | 使用工作台     | 允许使用区域内的工作台             |
| `openAnvil`          | 使用铁砧       | 允许使用区域内的铁砧               |
| `openEnchanting`     | 使用附魔台     | 允许使用区域内的附魔台             |
| `openHopper`         | 使用漏斗       | 允许使用区域内的漏斗               |
| `openDispenser`      | 使用发射器     | 允许使用区域内的发射器和投掷器     |
| `openDropper`        | 使用投掷器     | 允许使用区域内的发射器和投掷器     |
| `openShulker`        | 使用潜影盒     | 允许使用区域内的潜影盒             |
| `openBarrel`         | 使用桶         | 允许使用区域内的桶                 |
| `openFurnace`        | 使用熔炉       | 允许使用区域内的熔炉               |
| `openBlastFurnace`   | 使用高炉       | 允许使用区域内的高炉               |
| `openSmoker`         | 使用烟熏炉     | 允许使用区域内的烟熏炉             |
| `openCartography`    | 使用制图台     | 允许使用区域内的制图台             |
| `openStonecutter`    | 使用切石机     | 允许使用区域内的切石机             |
| `openBrewingStand`   | 使用酿造台     | 允许使用区域内的酿造台             |
| `openCrafter`        | 使用合成器     | 允许使用区域内的合成器             |
| `openBeacon`         | 使用信标       | 允许使用区域内的信标               |
| `openGrindstone`     | 使用砂轮       | 允许使用区域内的砂轮               |
| `openOtherContainer` | 使用其他容器   | 允许使用区域内的其他容器类型       |

### 管理

| ID                      | 名称             | 描述                                       |
| :---------------------- | :--------------- | :----------------------------------------- |
| `manage`                | 管理区域         | 允许管理区域设置和权限                     |
| `delete`                | 删除区域         | 允许删除整个区域                           |
| `grantAdminPermissions` | 授予管理权限     | 允许为玩家设置包含管理权限的权限组         |
| `setPlayerPermissions`  | 管理玩家权限     | 允许为其他玩家设置权限组                   |
| `resizeArea`            | 修改区域范围     | 允许更改区域的边界                         |
| `setAreaRules`          | 设置区域规则     | 允许修改区域规则                           |
| `rename`                | 修改区域名称     | 允许修改区域的名称                         |
| `subareaManage`         | 管理子区域       | 允许创建和管理子区域                       |
| `subareaSettings`       | 设置子区域       | 允许修改子区域的设置                       |

### 移动

| ID          | 名称       | 描述                   |
| :---------- | :--------- | :--------------------- |
| `enterArea` | 进入区域   | 允许玩家进入此区域     |
